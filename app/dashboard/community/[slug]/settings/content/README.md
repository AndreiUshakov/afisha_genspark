# –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–û —Å–æ–æ–±—â–µ—Å—Ç–≤–µ"

## –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–ª–æ–∫–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞–º —Å–æ–æ–±—â–µ—Å—Ç–≤ —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–û —Å–æ–æ–±—â–µ—Å—Ç–≤–µ" —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç—ã—Ö –∏ –≥–∏–±–∫–∏—Ö –±–ª–æ–∫–æ–≤.

## –¢–∏–ø—ã –±–ª–æ–∫–æ–≤

### 1. –ó–∞–≥–æ–ª–æ–≤–æ–∫ (H2)
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—Ç–æ—Ä–æ–≥–æ —É—Ä–æ–≤–Ω—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –ª–æ–≥–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–¥–µ–ª–æ–º

### 2. –¢–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
  - **–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç** (Bold)
  - *–ö—É—Ä—Å–∏–≤* (Italic)
  - –ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç
  - –ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
  - –ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
  - –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (–ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é, –ø–æ —Ü–µ–Ω—Ç—Ä—É, –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é)
  - –í—Å—Ç–∞–≤–∫–∞ —Å—Å—ã–ª–æ–∫

### 3. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–µ–¥–∏–∞–≥–∞–ª–µ—Ä–µ—é —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ: –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç (–¥–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ: –ø–æ–¥–ø–∏—Å—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 5 –ú–ë
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∫–µ—Ç–µ `community-media`

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏
- ‚ûï **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤**: –Ω–∞–∂–º–∏—Ç–µ "+ –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø
- ‚úèÔ∏è **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –±–ª–æ–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- üóëÔ∏è **–£–¥–∞–ª–µ–Ω–∏–µ**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –±–ª–æ–∫–∞
- ‚¨ÜÔ∏è‚¨áÔ∏è **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∏ –≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –±–ª–æ–∫–æ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ —Å—Ç–∞—Ç—É—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–π (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
app/dashboard/community/[slug]/settings/content/
‚îú‚îÄ‚îÄ page.tsx                           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ actions.ts                         # Server actions –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–ª–æ–∫–∞–º–∏
‚îú‚îÄ‚îÄ README.md                          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ ContentBuilder.tsx             # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
    ‚îú‚îÄ‚îÄ HeadingBlockEditor.tsx         # –†–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    ‚îú‚îÄ‚îÄ TextBlockEditor.tsx            # –†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤
    ‚îî‚îÄ‚îÄ ImageBlockEditor.tsx           # –†–µ–¥–∞–∫—Ç–æ—Ä –±–ª–æ–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

lib/types/
‚îî‚îÄ‚îÄ content-blocks.ts                  # TypeScript —Ç–∏–ø—ã –¥–ª—è –±–ª–æ–∫–æ–≤

components/content-blocks/
‚îî‚îÄ‚îÄ ContentBlocksPreview.tsx           # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª–æ–∫–æ–≤ –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ

supabase/migrations/
‚îî‚îÄ‚îÄ 20241215_create_community_content_blocks.sql  # –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞: `community_content_blocks`

```sql
- id: UUID (primary key)
- community_id: UUID (foreign key -> communities)
- block_type: TEXT ('heading' | 'text' | 'image')
- content: JSONB (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –±–ª–æ–∫–∞)
- position: INTEGER (–¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
- created_at: TIMESTAMPTZ
- updated_at: TIMESTAMPTZ
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ —Ç–∏–ø–∞–º

**–ó–∞–≥–æ–ª–æ–≤–æ–∫:**
```json
{
  "text": "–¢–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞"
}
```

**–¢–µ–∫—Å—Ç:**
```json
{
  "html": "<p>–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π <strong>HTML</strong> —Ç–µ–∫—Å—Ç</p>"
}
```

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
```json
{
  "url": "https://...",
  "alt": "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç",
  "caption": "–ü–æ–¥–ø–∏—Å—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### RLS (Row Level Security)
- –í–ª–∞–¥–µ–ª—å—Ü—ã —Å–æ–æ–±—â–µ—Å—Ç–≤ –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –±–ª–æ–∫–∞–º–∏ —Å–≤–æ–∏—Ö —Å–æ–æ–±—â–µ—Å—Ç–≤
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –±–ª–æ–∫–∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ—Å—Ç–≤
- –ù–µ–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∏ —Ç–∏–ø–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—á–µ—Ä–µ–∑ contentEditable)

## API

### Server Actions

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –±–ª–æ–∫–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
getContentBlocks(communityId: string)

// –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –±–ª–æ–∫
createContentBlock(communityId: string, input: CreateBlockInput)

// –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –±–ª–æ–∫
updateContentBlock(communityId: string, input: UpdateBlockInput)

// –£–¥–∞–ª–∏—Ç—å –±–ª–æ–∫
deleteContentBlock(communityId: string, blockId: string)

// –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –±–ª–æ–∫–æ–≤
reorderContentBlocks(communityId: string, blockIds: string[])

// –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –±–ª–æ–∫–∞
uploadBlockImage(formData: FormData)
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å–æ–æ–±—â–µ—Å—Ç–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "–ö–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã"
3. –ù–∞–∂–º–∏—Ç–µ "+ –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫"
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –±–ª–æ–∫–∞
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
6. –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
7. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ –±–ª–æ–∫–æ–≤

### –î–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π

–ë–ª–æ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–û —Å–æ–æ–±—â–µ—Å—Ç–≤–µ", –ø–æ—Å–ª–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–ª–µ–π (—Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è, –ø–æ–∂–µ–ª–∞–Ω–∏—è).

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–µ–∫—Ü–∏–∏
2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ 2 –ú–ë)
3. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç**: —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ SEO
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–ø–∏—Å–∏**: –ø–æ–º–æ–≥–∞—é—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º –ø–æ–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
5. **–§–æ—Ä–º–∞—Ç–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ —Å–ø–∏—Å–∫–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ-–±–ª–æ–∫–æ–≤
- [ ] –ë–ª–æ–∫ –≥–∞–ª–µ—Ä–µ–∏ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- [ ] –ë–ª–æ–∫ —Ü–∏—Ç–∞—Ç
- [ ] –ë–ª–æ–∫ –∫–Ω–æ–ø–æ–∫/—Å—Å—ã–ª–æ–∫
- [ ] Drag & Drop –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞
- [ ] –®–∞–±–ª–æ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü
- [ ] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞