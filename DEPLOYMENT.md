# Deployment Guide - Amvera

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é –ø—Ä–æ–µ–∫—Ç–∞ **–ê—Ñ–∏—à–∞ –ò—Ä–∫—É—Ç—Å–∫–∞** –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Amvera —Å CI/CD.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ê–∫–∫–∞—É–Ω—Ç –Ω–∞ [Amvera.io](https://amvera.io)
- GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞
- –í–µ—Ç–∫–∞ `main` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

1. –í–æ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Amvera
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –í—ã–±–µ—Ä–∏—Ç–µ **GitHub** –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫
4. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `afisha_genspark`
5. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É **main**

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ Amvera —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `amvera.yml` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `amvera.yml`:

```yaml
meta:
  environment: node
  toolchain:
    name: npm
    version: latest

build:
  env:
    NODE_ENV: production
  commands:
    - npm ci
    - npm run build

run:
  port: 3000
  persistStore: /app/.next
  command: npm run start
```

#### –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

- **environment: node** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Node.js –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- **toolchain.name: npm** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç npm –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **toolchain.version: latest** - –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è npm
- **build.env.NODE_ENV: production** - —Ä–µ–∂–∏–º production –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **build.commands**:
  - `npm ci` - —á–∏—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–±—ã—Å—Ç—Ä–µ–µ –∏ –Ω–∞–¥—ë–∂–Ω–µ–µ —á–µ–º npm install)
  - `npm run build` - —Å–±–æ—Ä–∫–∞ Next.js –ø—Ä–æ–µ–∫—Ç–∞
- **run.port: 3000** - –ø–æ—Ä—Ç –¥–ª—è Next.js —Å–µ—Ä–≤–µ—Ä–∞
- **run.persistStore: /app/.next** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏ –º–µ–∂–¥—É –¥–µ–ø–ª–æ—è–º–∏
- **run.command: npm run start** - –∑–∞–ø—É—Å–∫ production —Å–µ—Ä–≤–µ—Ä–∞

### 3. –í–µ—Ä—Å–∏—è Node.js

–§–∞–π–ª `.nvmrc` —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é Node.js:

```
20
```

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Next.js 16 –∏ React 19.

### 4. –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è

1. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è Amvera –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω—ë—Ç –ø–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π
2. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–π–º—ë—Ç 3-5 –º–∏–Ω—É—Ç
3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 5. CI/CD

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤–µ—Ç–∫–∏ `main`:

- **Push –≤ main** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- **Merge PR –≤ main** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- **Git tag** ‚Üí –¥–µ–ø–ª–æ–π —Å –≤–µ—Ä—Å–∏–µ–π

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è Supabase):

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Amvera
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **Environment Variables**
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

**–í–∞–∂–Ω–æ**: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `NEXT_PUBLIC_` –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: `/`
2. **–°–æ–±—ã—Ç–∏—è**: `/events`, `/events/[slug]`
3. **–°–æ–æ–±—â–µ—Å—Ç–≤–∞**: `/communities`, `/communities/[slug]`
4. **–≠–∫—Å–ø–µ—Ä—Ç—ã**: `/experts`, `/experts/[slug]`

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Build –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π "Out of memory"

**–†–µ—à–µ–Ω–∏–µ**: –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Amvera —É–≤–µ–ª–∏—á—å—Ç–µ RAM –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–æ –º–∏–Ω–∏–º—É–º 1GB.

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `next.config.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã `remotePatterns`:

```typescript
images: {
  remotePatterns: [
    {
      protocol: 'https',
      hostname: 'images.unsplash.com',
    },
  ],
}
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Module not found" –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ**: 
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `package.json`
2. –£–¥–∞–ª–∏—Ç–µ `node_modules` –∏ `package-lock.json` –ª–æ–∫–∞–ª—å–Ω–æ
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm install`
4. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `package-lock.json`

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–ø–ª–æ–π –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ build

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Amvera. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ RAM
- –ü—Ä–æ–±–ª–µ–º—ã —Å npm registry (–ø–æ–ø—Ä–æ–±—É–π—Ç–µ `npm ci --registry=https://registry.npmjs.org`)
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

Amvera –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- **–õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** - –≤–∫–ª–∞–¥–∫–∞ "Logs"
- **–ú–µ—Ç—Ä–∏–∫–∏ CPU/RAM** - –≤–∫–ª–∞–¥–∫–∞ "Metrics"
- **–ò—Å—Ç–æ—Ä–∏—è –¥–µ–ø–ª–æ–µ–≤** - –≤–∫–ª–∞–¥–∫–∞ "Deployments"

## üîÑ Rollback

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **Deployments**
2. –ù–∞–π–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Å–ø–µ—à–Ω—ã–π –¥–µ–ø–ª–æ–π
3. –ù–∞–∂–º–∏—Ç–µ **Rollback**

–ò–ª–∏ —á–µ—Ä–µ–∑ Git:

```bash
git revert HEAD
git push origin main
```

## üìù –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ï—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:

```yaml
meta:
  environment: node
  toolchain:
    name: npm
    version: 20

build:
  env:
    NODE_ENV: production
    NODE_OPTIONS: "--max-old-space-size=4096"
  commands:
    - npm install --legacy-peer-deps
    - npm run build

run:
  port: 3000
  command: npm run start
```

–ò–∑–º–µ–Ω–µ–Ω–∏—è:
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è Node.js (20)
- –£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `npm install` —Å `--legacy-peer-deps` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Amvera Documentation](https://docs.amvera.io)
- [Next.js Deployment](https://nextjs.org/docs/deployment)
- [GitHub Actions –¥–ª—è Amvera](https://github.com/marketplace/actions/amvera-deploy)

## üéØ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `package.json`
- [ ] `npm run build` —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] `amvera.yml` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
- [ ] `.nvmrc` —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é Node.js
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Amvera (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
- [ ] `next.config.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –í–µ—Ç–∫–∞ `main` –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

**–ì–æ—Ç–æ–≤–æ!** –ü–æ—Å–ª–µ —ç—Ç–∏—Ö —à–∞–≥–æ–≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –Ω–∞ Amvera –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main`. üöÄ
